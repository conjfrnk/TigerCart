<!-- This shows fun stats about the history of a user -->

{% extends "base.html" %}
{% block title %}Profile - TigerCart{% endblock %}

{% block content %}
<h1>Your Profile</h1>

<hr>

<h2><u>Your Contact Information</u></h2>
<ul>
    <li><strong>User ID:</strong> {{ username }}</li>
    
    <form method="POST" action="{{ url_for('profile') }}">
        <label for="venmo_handle"><strong>Venmo Username:</strong> @</label>
        <input type="text" name="venmo_handle" id="venmo_handle" value="{{ venmo_handle }}" required>
        <br><br>
        <label for="phone_number"><strong>Phone Number:</strong></label>
        <input type="tel" name="phone_number" id="phone_number" value="{{ phone_number }}" required pattern="[0-9]{10}">
        <br><br>
        <button type="submit">Save</button>
    </form>
</ul>

<hr>

<h2><u>Your Statistics</u></h2>
<ul>
    <li><strong>Total Orders: </strong>{{ stats.total_orders }}</li>
    <li><strong>Total Items Purchased: </strong>{{ stats.total_items }}</li>
    <li><strong>Total Money Spent: </strong>${{ "%.2f"|format(stats.total_spent) }}</li>
</ul>

<hr>

<h2><u>Your Order History</u></h2>
{% if orders %}
    <table style="border: 1px solid rgb(200, 200, 200); border-collapse: collapse;" align="center">
        <thead style="border: 1px solid rgb(200, 200, 200); background-color: rgb(250, 250, 250);">
            <tr>
                <td style="border: 1px solid rgb(200, 200, 200); padding: 10px;"><strong>Order ID</strong></td>
                <td style="border: 1px solid rgb(200, 200, 200);"><strong>Order Timestamp</strong></td>
                <td style="border: 1px solid rgb(200, 200, 200);"><strong>Total Items</strong></td>
                <td style="border: 1px solid rgb(200, 200, 200);"><strong>Status</strong></td>
                <td style="border: 1px solid rgb(200, 200, 200);"><strong>Total ($)</strong></td>
                <td style="border: 1px solid rgb(200, 200, 200);"><strong>Details</strong></td>
            </tr>
        </thead>
        <tbody>
            {% for order in orders %}
            <tr>
                <td style="border: 1px solid rgb(200, 200, 200); padding: 20px;">{{ order.id }}</td>
                <td style="border: 1px solid rgb(200, 200, 200);">{{ order.timestamp }}</td>
                <td style="border: 1px solid rgb(200, 200, 200);">{{ order.total_items }}</td>
                <td style="border: 1px solid rgb(200, 200, 200);">{{ order.status }}</td>
                <td style="border: 1px solid rgb(200, 200, 200);">{{ "%.2f"|format(order.total) }}</td>
                <td style="border: 1px solid rgb(200, 200, 200);"><a href="{{ url_for('order_details', order_id=order.id) }}">View</a></td>
            </tr>
            {% endfor %}
        </tbody>
    </table>
{% else %}
    <p>You have no orders yet.</p>
{% endif %}
{% endblock %}
